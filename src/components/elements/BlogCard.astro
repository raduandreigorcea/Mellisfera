---
import FormattedDate from '@components/FormattedDate.astro';

interface Props {
  href: string;
  title: string;
  date: Date;
  description?: string;
  imageSrc?: string;
  badge?: string;
}

const { href, title, date, description, imageSrc, badge = 'BLOG', ...attrs } = Astro.props as Props & Record<string, any>;
---

<li class="post-card" {...attrs}>
  <a class="post-link" href={href}>
    <div class="thumb-wrap">
      {badge && <span class="badge label-small">{badge}</span>}
      {imageSrc ? (
        <img class="post-thumb" src={imageSrc} width={720} height={360} alt="" loading="lazy" />
      ) : (
        <div class="post-thumb placeholder" aria-hidden="true" />
      )}
    </div>
    <div class="post-meta">
      <p class="post-date label-small"><FormattedDate date={date} /></p>
      <h3 class="post-title title-small">{title}</h3>
      {description && <p class="post-desc text-normal">{description}</p>}
    </div>
  </a>
</li>

<style>
  .post-card {
    border-radius: 14px;
    overflow: hidden;
    background: var(--element-background);
    box-shadow: 0 1px 2px rgba(0,0,0,0.03);
    transition: transform .2s ease, box-shadow .2s ease;
    width: 100%;
  }
  .post-link { 
    text-decoration: none; color: inherit; display: grid; grid-template-rows: auto 1fr; height: 100%; position: relative; 
  }
  .post-link:focus-visible { outline: 3px solid var(--button-background-hover); outline-offset: 3px; border-radius: 12px; }
  .post-card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.08); }
  .thumb-wrap { position: relative; }
  .post-thumb { display:block; width:100%; height:auto; object-fit:cover; aspect-ratio:16/9; }
  .post-thumb.placeholder { background: var(--element-background); }
  .badge { position:absolute; top:10px; left:10px; z-index:1; background: var(--button-background); color: var(--dark-text); padding:.25rem .5rem; border-radius:999px; }
  .post-meta { padding: .9rem 1rem 1.1rem; }
  .post-date { margin: 0 0 .35rem 0; }
  .post-title { margin: 0 0 .35rem 0; }
  .post-desc { margin: 0; }

  /* Neutralize global link underline/hover coming from button styles */
  .post-link::after { content: none !important; }
  .post-link:hover::after { content: none !important; }
  .post-link:hover { color: inherit; }

  @media (max-width: 640px){
    .post-meta { padding: .75rem .85rem .9rem; }
  }
</style>
